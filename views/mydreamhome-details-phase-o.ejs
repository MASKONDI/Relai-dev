<%- include('dashboard_header')-%>
  <%- include('edit-profile-model')-%>
    <!-- The Modal -->
    <div class="modal permission-modal fade " id="myModal">
      <div class="modal-dialog">
        <div class="modal-content">

          <!-- Modal Header -->
          <div class="modal-header text-center">
            <h2 class="modal-title w-100">Raise a Complaint</h2>
          </div>

          <!-- Modal body -->
          <div class="modal-body">
            <select class="form-control " id="selectBox">
              <option value="0">Select professional</option>
              <option value="">2</option>
            </select>

            <input type="text" class="form-control  form-control-fix2" id="subject" placeholder="Subject"
              name="subject">
            <textarea class="form-control  form-control-fix2" rows="3" id="comment">Add Notes</textarea>

            <div class="model-btn-fix">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-cancel" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-cancel" data-dismiss="modal">Submit</button>
          </div>
        </div>
      </div>
    </div>
    <div class="dashboard-wpr">
      <div class="container-fluid">
        <div class="row content">
          <div class="col-sm-2 sidenav hidden-xs-down">
            <div class="user-login text-center">

              <%- include('profile-image')-%>

                <div class="user-name">
                  <h2>
                    <%= session.name %>
                  </h2>
                  <a href="#">
                    <%= session.email %>
                      <%- include('edit-profile-icon')-%>
                  </a>
                </div>
            </div>
            <%- include('sidebar')-%>
          </div>
          <div class="col-sm-12 col-lg-10">
            <div class="dashboard-inner">
              <div class="row">
                <div class="breadcumb">
                  <ul>
                    <li><a href="/mydreamhome-details"
                        onclick="location.href=this.href+'?id='+scrt_var;return false;"><i class="fa fa-long-arrow-left"
                          aria-hidden="true" id="backtodeatils"></i> Back
                        to <%=propertyData.ps_property_name%></a>
                    </li>

                  </ul>
                </div>
              </div>
              <div class="todo-list-table">
                <div class="clearfix">
                  <div class="heading-top float-left">
                    <input type="hidden" class="phsename" value="<%=phase%>">
                    <h2>
                      <%=propertyData.ps_property_name%> <i class="fa fa-long-arrow-left" aria-hidden="true"></i> Phase
                        <%=step%> :<%=phase%>
                    </h2>
                  </div>
                  <div class="total-time-cost float-right">
                    <div class="total-time"><a href="#">TOTAL TIME<br><span>525 days</span></a></div>
                    <div class="total-time"><a href="#">TOTAL COST<br><span>100,000 ï¿¡</span></a></div>
                  </div>
                </div>
                <!-- <div class="phase-progress">
                  <ul>
                    <li><a href="javascript:void(0)">25%</a></li>
                    <li><a href="javascript:void(0)">25%</a></li>
                    <li><a href="javascript:void(0)">25%</a></li>
                    <li><a href="javascript:void(0)">25%</a></li>
                  </ul>
                </div> -->
                <div class="phase-progress">
                  <div data-toggle="tooltip" data-placement="top" title="50%" data-original-title=""
                  class="progress" style="height:2.5rem; border-radius: 1.25rem;">
                  
                  <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="100"
                  aria-valuemin="0" aria-valuemax="100" style='width:50%; background-color:#005377;overflow:hidden; display:inline-block;'>
                  </div>
                  </div>
                  </div>
                <div class="action-owner">
                  <div class="clearfix">
                    <div class="float-left">
                      <p>Action</p>
                    </div>
                    <div class="float-left">
                      <p>Action Owners</p>
                    </div>
                    <% if(session.active_user_login=='buyer' ){%>
                      <!-- <div class="float-right">
                        <a href="#" class="add-professionals" data-toggle="modal" data-target="#buyerPhaseA">Add
                          Existing Task</a>
                      </div> -->
                      <%} else if(session.active_user_login=='seller' ){%>
                        <!-- <div class="float-right">
                          <a href="#" class="add-professionals" data-toggle="modal" data-target="#sellerPhaseA">Add
                            Existing Task</a>
                        </div> -->
                        <%} else {%>
                          <!-- <div class="float-right">
                            <a href="#" class="add-professionals" data-toggle="modal" data-target="#renovatorPhaseA">Add
                              Existing Task</a>
                          </div> -->
                          <%}%>
                            <!-- <div class="float-right">
                              <a href="#" class="add-professionals" data-toggle="modal" data-target="#addTask">Add
                                Task</a>
                            </div> -->

                  </div>
                </div>
                <table class="table  table-phase-fix-2">
                  <thead>
                    <tr>
                      <th>Task</th>
                      <!-- <th>Buyer</th>
                      <th>Solicitor</th> -->
                      <%if(hiredProfessional_list.length>0){%>
                        <%hiredProfessional_list.forEach(function(row,i){%>
                          <th>
                            <%=row.sps_fullname%>
                          </th>
                          <!-- <th>Professional B</th>
                      <th>Professional C</th> -->
                          <%})%>
                            <%}else{%>
                              <th>Professional NA</th>
                              <%}%>
                                <th></th>
                                <th>Status</th>
                                <th>Action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <%if(taskObject.length==0){%>
                      <tr>
                        <td style='text-align: right;'>Task Not Found</td>
                      </tr>
                      <%}else{%>
                        <%taskObject.forEach(function(row,i){%>
                          <tr>
                            <td> <label class="check-todos">
                              <p>
                                <%=row.ppts_task_name%>
                              </p>

                              <%if(row.iscompleteStatus==true){%>
                                <input type="checkbox" checked disabled>

                                <%}else{%>
                                  <input type="checkbox">
                                  <%}%>
                                    <span class="checkmark"></span>
                            </label></td>

                            <!-- <td><a href="#" class="upload-any"><img src="images/upload.png">
                                <span>
                                  <div class="custom-file-input">
                                     <input type="file" name="task-document" >
                                    <input type="button">
                                  </div>
                                </span>
                              </a>
                              <a href="/professionals-detail-message"><img src="images/chat.png"></a>
                            </td>
                            <td><a href="#" class="upload-any"><img src="images/upload.png">
                                <span>
                                  <div class="custom-file-input">
                                     <input type="file" name="task-document" >
                                    <input type="button">
                                  </div>
                                </span>
                              </a>
                              <a href="/professionals-detail-message"><img src="images/chat.png"></a>
                            </td> -->
                            <%if(hiredProfessional_list.length>0){%>
                              <%hiredProfessional_list.forEach(function(hp,k){%>
                                <%if(row.ppts_assign_to.includes(hp._id.toString())){
                                  index=row.ppts_assign_to.indexOf(hp._id.toString()) %>
                                  <td>
                                    <%if(row.ppts_task_status[index]=='completed_by_service_provider'){%>
                                      <div class="complete-circle" data-toggle="tooltip" data-placement="top"
                                      title="Complete"></div>
                                      <%}else if(row.ppts_task_status[index]=='in_progress' ){%>
                                        <div class="inprogress-circle" data-toggle="tooltip" data-placement="top"
                                        title="In Progress"></div>
                                        <%}else{%>
                                          <div class="pending-circle" data-toggle="tooltip" data-placement="top"
                                          title="Pending"></div>
                                          <%}%><a href="#" class="upload-any"><img src="images/upload.png">
                                    <span>
                                      <div class="custom-file-input">
                                         <input type="file" name="task-document" onchange="previewFile_upload_task_document(this,'<%=row._id%>','<%=hp._id%>','<%=row.ppts_phase_name%>','<%=row.ppts_task_name%>','<%=row.ppts_property_id%>','O')">
                                        <input type="button">
                                      </div>
                                    </span>
                                  </a>
                                  <a href="/mydreamhome-details-message?id=<%=row.ppts_property_id%>&pid=<%=hp._id%>"><img src="images/chat.png"></a>
                                </td>
                                <%}else{%>
                                  <td>
                                  <p>...</p>
                                </td>
                                  <%}%>
                                  <%});%>
                                    <%}%>
                                    <td><a class="btn help-btn" href="#" data-toggle="modal"
                                        data-target="#myModal">Help</a>
                                    </td>
                                    <td>
                                      <%if(row.iscompleteStatus==true){%>
                                        <a class="btn btn-complete">Complete</a>
                                        <%}else if(row.ispendingStatus==true ){%>
                                          <a class="btn btn-pending">Pending</a>
                                          
                                          <%}else if(row.iscompleteStatus==false && row.ispendingStatus==false){%>
                                            <a class="btn btn-progress">In Progress</a>
                                            <%}%>
                                    </td>
                                    <td><i class="fa fa-pencil editbtn" data-toggle="modal"
                                        data-target="#todoNotesModal<%=row._id%>"></i></td>
                                    <td>
                                      <div id="todoNotesModal<%=row._id%>" class="modal fade" role="dialog">
                                        <div class="modal-dialog">
                                          <div class="modal-content">
                                            <div class="modal-header">
                                              <button type="button" class="close" data-dismiss="modal">&times;</button>

                                            </div>
                                            <div class="modal-body">
                                              <p>
                                                <%=row.ppts_note%>
                                              </p>
                                            </div>
                                            <div class="modal-footer">
                                              <button type="button" class="btn btn-default"
                                                data-dismiss="modal">Close</button>
                                            </div>
                                          </div>

                                        </div>
                                      </div>
                                    </td>
                          </tr>
                          <%});%>
                            <%}%>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
    <%- include('dashboard_footer')-%>