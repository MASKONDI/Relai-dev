<%- include('head')-%>
  <div class="wrapper dashboard">
    <nav class="navbar navbar-expand-lg d-block d-xs-none d-lg-none">
      <a class="navbar-brand" href="/index"><img src="images/logo-2.png"></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
      <div class="user-right">
        <ul class="login-menu">
          <li class="dropdown"><a href="#" class="dropdown-toggle" type="button" id="dropdownMenuButton"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img src="images/recent-user-1.png"
                width="40" height="40" class="rounded-circle"> John <i class="fa fa-angle-down"
                aria-hidden="true"></i></a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#">Setting</a>
              <a class="dropdown-item" href="#">Account</a>
              <a class="dropdown-item" href="#">Log Out</a>
            </div>
          </li>
        </ul>
      </div>
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="/signup-professionals-profile"><img class="act-img" src="images/1-active.png"><img
                src="images/1.png">PERSONAL DETAILS </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-2"><img class="act-img"
                src="images/2-active.png"><img src="images/2.png"> OTHER DETAILS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-3"><img class="act-img"
                src="images/3-active.png"><img src="images/3.png"> EDUCATION</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-4"><img class="act-img"
                src="images/4-active.png"><img src="images/4.png"> EMPLOYMENT HISTORY</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-5"><img class="act-img"
                src="images/5-active.png"><img src="images/5.png"> REFERENCES</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-6"><img class="act-img"
                src="images/6-active.png"><img src="images/6.png"> PROFESSIONAL INDEMNITY
              INSURANCE</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-7"><img class="act-img"
                src="images/7-active.png"><img src="images/7.png"> LANGUAGE</a>
          </li>
        </ul>
      </div>
    </nav>





    <div class="dashboard-wpr">
      <div class="container-fluid">
        <div class="row content">
          <div class="col-sm-3 sidenav2 hidden-xs-down">
            <div class=" text-center">
              <div class="">
                <a href="/index"><img src="images/logo-2.png"></a>
              </div>

            </div>
            <ul class="dashboard-nav">
              <li class="active">
                <a href="/signup-professionals-profile" class ="personal_detail_nev"><img class="act-img" src="images/1-active.png"><img
                    src="images/1.png">PERSONAL DETAILS </a>
              </li>
              <li>
                <a href="javascript:void(0)" data-href="/signup-professionals-profile-2"class ="other_detail_nev"><img class="act-img" src="images/2-active.png"><img
                    src="images/2.png"> OTHER DETAILS</a>
              </li>
              <li>
                <a href="javascript:void(0)" data-href="/signup-professionals-profile-3" class ="education_detail_nev"><img class="act-img" src="images/3-active.png"><img
                    src="images/3.png"> EDUCATION</a>
              </li>
              <li>
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-4" class ="employment_detail_nev"><img class="act-img" src="images/4-active.png"><img
                    src="images/4.png"> EMPLOYMENT HISTORY</a>
              </li>

              <li>
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-5" class ="refrence_detail_nev"><img class="act-img" src="images/5-active.png"><img
                    src="images/5.png"> REFERENCES</a>
              </li>
              <li>
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-6" class ="indemnity_detail_nev"><img class="act-img" src="images/6-active.png"><img
                    src="images/6.png"> PROFESSIONAL INDEMNITY
                  INSURANCE</a>
              </li>
              <li>
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-7" class ="language_detail_nev"><img class="act-img" src="images/7-active.png"><img
                    src="images/7.png"> LANGUAGE</a>
              </li>
            </ul>
          </div>
          <%if(data==null){%>
          <div class="col-sm-12 col-lg-9">
            <div class=" dashboard-inner">
              <div class="row">
                <div class="col-sm-12 col-lg-9">
                  <div class="signup-header">
                    <!-- <p>START FOR FREE</p> -->

                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-12 col-lg-9">
                  <div class="signup-head">
                    <h3>Personal Details</h3>
                  </div>
                </div>
                <div class="col-sm-12 col-lg-3">
                  <div class="page-count">
                    <p> 1 of 6</p>
                  </div>
                </div>
              </div>
              <form action="/api/service_provider_personal_details" class="form form-section" method="post" id="form1">
                <% if(typeof err_msg!='undefined' ){ %>
                  <span class="error_validate flash_msg" style="color: red; padding-bottom: 20px;">
                    <%= err_msg %>
                  </span>
                  <% }%>
                    <% if(typeof success_msg!='undefined' ){ %>
                      <span class="succ_flash_msg" style="color: green;">
                        <%= success_msg %>
                      </span>
                      <% }%>

                        <div class="row">
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <input type="text" class="form-control text-field-size spods_surname " id="" placeholder="Surname"
                                name="spods_surname" required data-rule-required="true"
                                data-msg-required="Surname is required" value="<%= session.sps_lastname%>" readonly>
                              </input>
                              
                            </div>
                          </div>
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <input type="text" class="form-control text-field-size spods_fornames " id="" placeholder="Forename"
                                name="spods_fornames" required data-rule-required="true"
                                data-msg-required="Forename is required" value="<%= session.sps_firstname%>" readonly>
                            </div>
                          </div>
                        </div>


                        <div class="row">
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <select class="form-control required spods_preferred_title" id="selectBox2" name="spods_preferred_title"
                                data-rule-required="true" data-msg-required="Preferred Title is required" required>
                                <option value="">Preferred Title</option>
                                <option value="mr">Mr</option>
                                <option value="miss">Miss</option>
                                <option value="mrs">Mrs</option>
                              </select>
                            </div>

                          </div>
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <input type="text" class="form-control text-field-size spods_former_surnames" id=""
                                placeholder="Former Surnames(if different from above)" name="spods_former_surnames"
                                value="<%= session.sps_lastname%>" required>
                            </div>
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix" id=''>
                              <input type="text" class="datepicker form-control text-field-size spods_dob " id="datePickerId" placeholder="Date of Birth"
                                onfocus="(this.type='date')" min="1980-01-01" name="spods_dob" data-rule-required="true"
                                data-msg-required="Date of birth is required" required>
                            </div>
                          </div>
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <input type="text" class="form-control text-field-size spods_nationality" id="" placeholder="Nationality"
                                name="spods_nationality" required>
                            </div>
                          </div>
                        </div>


                        <div class="row">
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <input type="text" class="form-control text-field-size spods_address" id="" placeholder="Address"
                                name="spods_address" value="<%= session.sps_address%>" readonly>
                            </div>
                          </div>
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <input type="text" class="form-control text-field-size spods_postcode" id="" placeholder="Post code"
                                name="spods_postcode" required>
                            </div>
                          </div>
                        </div>


                        <div class="row">
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <input type="text" class="form-control text-field-size spods_home_telephone_number" id=""
                                placeholder="Home Telephone Number" name="spods_home_telephone_number" required>
                            </div>
                          </div>
                          <div class="col-sm-12 col-lg-6">
                            <div class="input-box-size-fix">
                              <select class="form-control spods_postcode_covered" id="selectBox2" name="spods_postcode_covered" required>
                                <option value="0">Post codes covered</option>
                                <option value=""></option>
                              </select>
                            </div>
                          </div>
                        </div>


                        <div class="row">
                          <div class="col-sm-12 col-lg-8">
                            <div class="profile-notes">
                              <p>If the application is successfully submitted, when are you able to start working for Relai?</p>
                            </div>
                          </div>
                          <div class="col-sm-12 col-lg-4">
                            <div class="input-box-size-fix">
                              <input type="text" onfocus="(this.type='date')" min="1980-01-01" class="form-control text-field-size start_working_time"
                                id="start_working_time" placeholder="Start Date" name="start_working_time" required>
                            </div>
                          </div>
                        </div>





                        <div class="row">
                          <div class="col-6 col-sm-6 col-lg-6">
                            <div class="prev-btn float-left">
                              <!-- <a href="#" class="btn previous-btn" style="width: 164px; ">
                                PREVIOUS</a> -->
                            </div>
                          </div>


                          <div class="col-6 col-sm-6 col-lg-6">
                            <div class="prev-btn float-right">
                              <!-- <a href="/signup-professionals-profile-2" class="btn btn-next" style="width: 164px;">
                        NEXT</a> -->
                               <input type="hidden" name="personal_detail_id"class="personal_detail_id" value="">
                              <button id="clickme" type="submit" name="submit" class="btn btn-next"
                                style="width: 164px;">
                                NEXT</button>
                            </div>
              </form>
            </div>
          </div>
          <%}else{%>
            <div class="col-sm-12 col-lg-9">
              <div class=" dashboard-inner">
                <div class="row">
                  <div class="col-sm-12 col-lg-9">
                    <div class="signup-header">
                      <!-- <p>START FOR FREE</p> -->
  
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12 col-lg-9">
                    <div class="signup-head">
                      <h3>Update Personal Details</h3>
                    </div>
                  </div>
                  <div class="col-sm-12 col-lg-3">
                    <div class="page-count">
                      <p> 1 of 6</p>
                    </div>
                  </div>
                </div>
                <form action="/api/service_provider_personal_details" class="form form-section" method="post" id="form1">
                  <% if(typeof err_msg!='undefined' ){ %>
                    <span class="error_validate flash_msg" style="color: red; padding-bottom: 20px;">
                      <%= err_msg %>
                    </span>
                    <% }%>
                      <% if(typeof success_msg!='undefined' ){ %>
                        <span class="succ_flash_msg" style="color: green;">
                          <%= success_msg %>
                        </span>
                        <% }%>
  
                          <div class="row">
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <input type="text" class="form-control text-field-size spods_surname " id="" placeholder="Surname"
                                  name="spods_surname" required data-rule-required="true"
                                  data-msg-required="Surname is required" value="<%= session.sps_lastname%>" readonly>
                                </input>
                                
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <input type="text" class="form-control text-field-size spods_fornames " id="" placeholder="Forename"
                                  name="spods_fornames" required data-rule-required="true"
                                  data-msg-required="Forename is required" value="<%= session.sps_firstname%>" readonly>
                              </div>
                            </div>
                          </div>
  
  
                          <div class="row">
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <select class="form-control required spods_preferred_title" id="selectBox2" name="spods_preferred_title"
                                  data-rule-required="true" data-msg-required="Preferred Title is required" required>
                                  <option value="">Preferred Title</option>
                                  <option value="mr">Mr</option>
                                  <option value="miss">Miss</option>
                                  <option value="mrs">Mrs</option>
                                </select>
                              </div>
  
                            </div>
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <input type="text" class="form-control text-field-size spods_former_surnames" id=""
                                  placeholder="Former Surnames(if different from above)" name="spods_former_surnames"
                                  value="<%= session.sps_lastname%>" required>
                              </div>
                            </div>
                          </div>
  
                          <div class="row">
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix" id=''>
                                <input type="text" class="datepicker form-control text-field-size spods_dob " id="datePickerId" placeholder="Date of Birth"
                                  onfocus="(this.type='date')" min="1980-01-01" name="spods_dob" data-rule-required="true"
                                  data-msg-required="Date of birth is required" required>
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <input type="text" class="form-control text-field-size spods_nationality" id="" placeholder="Nationality"
                                  name="spods_nationality" required>
                              </div>
                            </div>
                          </div>
  
  
                          <div class="row">
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <input type="text" class="form-control text-field-size spods_address" id="" placeholder="Address"
                                  name="spods_address" value="<%= session.sps_address%>" readonly>
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <input type="text" class="form-control text-field-size spods_postcode" id="" placeholder="Post code"
                                  name="spods_postcode" required>
                              </div>
                            </div>
                          </div>
  
  
                          <div class="row">
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <input type="text" class="form-control text-field-size spods_home_telephone_number" id=""
                                  placeholder="Home Telephone Number" name="spods_home_telephone_number" required>
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix">
                                <select class="form-control spods_postcode_covered" id="selectBox2" name="spods_postcode_covered" required>
                                  <option value="0">Post codes covered</option>
                                  <option value=""></option>
                                </select>
                              </div>
                            </div>
                          </div>
  
  
                          <div class="row">
                            <div class="col-sm-12 col-lg-8">
                              <div class="profile-notes">
                                <p>If the application is successfully submitted, when are you able to start working for Relai?</p>
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-4">
                              <div class="input-box-size-fix">
                                <input type="text" onfocus="(this.type='date')" min="1980-01-01" class="form-control text-field-size start_working_time"
                                  id="start_working_time" placeholder="Start Date" name="start_working_time" required>
                              </div>
                            </div>
                          </div>
                                <input type="hidden" name="isedit" value="1">
                                <input type="hidden" name="personal_detail_id" value="<%=data._id%>">
                          <button type="submit" class="btn btn-next" style="width: 164px;">
                            Update</button>
                </form>
              </div>
            </div>
           <%}%>
        </div>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" src="../js/countrystatecity.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.2/jquery.validate.min.js"
  integrity="sha512-UdIMMlVx0HEynClOIFSyOrPggomfhBKJE28LKl8yR3ghkgugPnG6iLfRfHwushZl1MOPSY6TsuBDGPK2X4zYKg=="
  crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.js"></script>
  <!-- <script type="text/javascript">
    $(document).ready(function () {
      $('.other_detail_nev').attr('disabled',true)
    })
    </script> -->
  <script type="text/javascript">
    $('#form1').validate({
      onfocusout: function (element) {
        this.element(element);
      },
      errorClass: 'error_validate',
      errorElement: 'span',
      highlight: function (element, errorClass) {
        $(element).removeClass(errorClass);
      },
      submitHandler: function (form) {
       


      }
    });
  </script>
  <script type="text/javascript">
    // window.onload = function () {
    //   document.getElementById('ifYes').style.display = 'none';
    // }

    // function yesnoCheck() {
    //   if (document.getElementById('yesCheck').checked) {
    //     document.getElementById('ifYes').style.display = 'block';
    //   }
    //   else {
    //     document.getElementById('ifYes').style.display = 'none';
    //   }
    // }

  </script>
  <script type="text/javascript">
    $(document).ready(function () {
      var flash_msg = $('.flash_msg').html();
      if (flash_msg != "" && flash_msg != undefined) {
        setTimeout(function () { $('.flash_msg').html(''); }, 4000);
      }
    });

    $(document).ready(function () {
      var succ_flash_msg = $('.succ_flash_msg').html();
      if (succ_flash_msg != "" && succ_flash_msg != undefined) {
        setTimeout(function () { $('.succ_flash_msg').html(''); }, 4000);
      }
    });  
  </script>
  <script>
    $("#clickme").click(function () {

      if ($("#selectBox2 option:selected").val() == '0') {

        // alert("Please select one option at least");
        $("#err_msg").html("Select At least one option");
      }
    });
  </script>
   <script>
    $(document).ready(function () {
      datePickerId.max = new Date().toISOString().split("T")[0];
      start_working_time.min=new Date().toISOString().split('T')[0]
      var data = {
        user_id:'<%= session.user_id%>'
      }
      $.ajax({
          type: "GET",
          data: data,
          url: "/api/service_provider_personal_details",
          cache: false,
          success: function (data) {
            console.log(data);
            if (data.status == true) {
              var newHref = $('.other_detail_nev').attr('data-href');
            	$('.other_detail_nev').attr('href',newHref);
              $('.spods_surname').val(data.data.spods_surname);
              $('.spods_fornames').val(data.data.spods_fornames);
              $('.spods_preferred_title').val(data.data.spods_preferred_title);
              $('.spods_former_surnames').val(data.data.spods_former_surnames);
              $('.spods_dob').val(data.spods_dob);
              $('.spods_nationality').val(data.data.spods_nationality);
              $('.spods_address').val(data.data.spods_address);
              $('.spods_postcode').val(data.data.spods_postcode);
              $('.spods_home_telephone_number').val(data.data.spods_home_telephone_number);
              $('.spods_postcode_covered').val(data.data.spods_postcode_covered);
              $('.start_working_time').val(data.spods_start_working_time);
              $('.personal_detail_id').val(data.data._id);

            }else{

            }

          }
        });
        $('#form1').submit(function(e){
          e.preventDefault()
          $('.loader-box').attr('style', 'display:flex !important');
        var formData = $('#form1').serialize();
        console.log('formData:', formData)

        $.ajax({
          type: "POST",
          data: formData,
          url: "/api/service_provider_personal_details",
          cache: false,
          success: function (data) {
            console.log(data);

            if (data.status == false) {

              $('.loader-box').attr('style', 'display:none !important');
              Swal.fire({
                icon: 'error',
                title: data.message,
                showConfirmButton: false,
                confirmButtonColor: '#005377',
                timer: 4000
              })

            } else {
              $('.loader-box').attr('style', 'display:none !important');

              Swal.fire({
                icon: 'success',
                title: data.message,
                showConfirmButton: false,
                confirmButtonColor: '#005377',
                timer: 4000
              })
              if(data.action=='isedit'){
                setTimeout(function () {
                //location.reload(true);
                window.location.href = "/service-provider/dashboard-professional";
              }, 4000)
              }else{
                setTimeout(function () {
                //location.reload(true);
                window.location.href = "/signup-professionals-profile-2";
              }, 4000)
              }
              ;

            }
          }
        });
        })
    });
  </script>
   <script type="text/javascript">
   

</script>
  </body>

  </html>