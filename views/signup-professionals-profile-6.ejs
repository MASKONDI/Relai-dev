<%- include('head')-%>
  <div class="wrapper dashboard">
    <nav class="navbar navbar-expand-lg d-block d-xs-none d-lg-none">
      <a class="navbar-brand" href="/index"><img src="images/logo-2.png"></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </button>
      <div class="user-right">
        <ul class="login-menu">
          <li class="dropdown"><a href="#" class="dropdown-toggle" type="button" id="dropdownMenuButton"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img src="images/recent-user-1.png"
                width="40" height="40" class="rounded-circle"> John <i class="fa fa-angle-down"
                aria-hidden="true"></i></a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <a class="dropdown-item" href="#">Setting</a>
              <a class="dropdown-item" href="#">Account</a>
              <a class="dropdown-item" href="#">Log Out</a>
            </div>
          </li>
        </ul>
      </div>
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <ul class="navbar-nav">
          <li class="nav-item ">
            <a class="nav-link" href="/signup-professionals-profile"><img class="act-img" src="images/1-active.png"><img
                src="images/1.png">PERSONAL DETAILS </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-2"><img class="act-img"
                src="images/2-active.png"><img src="images/2.png"> OTHER DETAILS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-3"><img class="act-img"
                src="images/3-active.png"><img src="images/3.png"> EDUCATION</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-4"><img class="act-img"
                src="images/4-active.png"><img src="images/4.png"> EMPLOYMENT HISTORY</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="/signup-professionals-profile-5"><img class="act-img"
                src="images/5-active.png"><img src="images/5.png"> REFERENCES</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="/signup-professionals-profile-6"><img class="act-img"
                src="images/6-active.png"><img src="images/6.png"> PROFESSIONAL INDEMNITY
              INSURANCE</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/signup-professionals-profile-7"><img class="act-img"
                src="images/7-active.png"><img src="images/7.png"> LANGUAGE</a>
          </li>
        </ul>
      </div>
    </nav>





    <div class="dashboard-wpr">
      <div class="container-fluid">
        <div class="row content">
          <div class="col-sm-3 sidenav2 hidden-xs-down">
            <div class=" text-center">
              <div class="">
                <a href="/index"><img src="images/logo-2.png"></a>
              </div>

            </div>
            <ul class="dashboard-nav">
              <li class="completed">
                <a href="/signup-professionals-profile" class ="personal_detail_nev">
                  <img class="complete-img" src="images/checked.png">
                  <img class="act-img" src="images/1-active.png">
                  <img src="images/1.png">
                  PERSONAL DETAILS
                </a>
              </li>
              <li >
                <a href="javascript:void(0)" data-href="/signup-professionals-profile-2"class ="other_detail_nev"><img class="act-img" src="images/2-active.png"><img
                    src="images/2.png"> OTHER DETAILS</a>
              </li>
              <li>
                <a href="javascript:void(0)" data-href="/signup-professionals-profile-3" class ="education_detail_nev"><img class="act-img" src="images/3-active.png"><img
                    src="images/3.png"> EDUCATION</a>
              </li>
              <li >
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-4" class ="employment_detail_nev"><img
                    src="images/4.png"> EMPLOYMENT HISTORY</a>
              </li>

              <li>
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-5" class ="refrence_detail_nev"><img class="act-img" src="images/5-active.png"><img
                    src="images/5.png"> REFERENCES</a>
              </li>
              <li  class="active">
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-6" class ="indemnity_detail_nev"><img class="act-img" src="images/6-active.png"><img
                    src="images/6.png"> PROFESSIONAL INDEMNITY
                  INSURANCE</a>
              </li>
              <li >
                <a href="javascript:void(0)"  data-href="/signup-professionals-profile-7" class ="language_detail_nev"><img class="act-img" src="images/7-active.png"><img
                    src="images/7.png"> LANGUAGE</a>
              </li>
            </ul>
          </div>

          <div class="col-sm-12 col-lg-9">
            <div class=" dashboard-inner">
              <div class="row">
                <div class="col-sm-12 col-lg-9">
                  <div class="signup-header">
                    <!-- <p>START FOR FREE</p> -->
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-12 col-lg-9">
                  <div class="signup-head">
                    <h3>Professional Indemnity Insurance</h3>
                  </div>
                </div>
                <div class="col-sm-12 col-lg-3">
                  <div class="page-count">
                    <p> 6 of 7</p>
                  </div>
                </div>
              </div>
              <form action="/api/service_provider_indemnity_details" method="post" class="form form-section" id="form6">
                <% if(typeof success_msg!='undefined' ){ %>
                  <span class="succ_flash_msg" style="color: green;">
                    <%= success_msg %>
                  </span>
                  <% }%>

                    <div class="row">
                      <div class="col-sm-12 col-lg-4">
                        <div class="profile-notes">
                          <p>Have you had any PI claims?
                          </p>
                        </div>
                      </div>

                      <div class="col-sm-12 col-lg-2">
                        <div class="profile-radio">
                          <label class="radio-inline">
                            <input type="radio" name="spods_option_pl_claims" value="yes"
                              onclick="javascript:yesnoCheck();" id="yesCheck_p6" >
                            &nbsp;Yes&nbsp;&nbsp;
                          </label>
                          <label class="radio-inline">
                            <input type="radio" checked name="spods_option_pl_claims" value="no"
                              onclick="javascript:yesnoCheck();" id="noCheck_p6"> &nbsp;No&nbsp;&nbsp;
                          </label>
                        </div>
                      </div>

                      <div class="col-sm-12 col-lg-6">
                        <div class="input-box-size-fix3">
                          <p>*Give full details including nature of claim and quantum</p>
                        </div>
                      </div>
                    </div>
                    <% if(typeof err_msg!='undefined' ){ %>
                      <span class="error_validate flash_msg" style="color: red; padding-bottom: 10px;">
                        <%= err_msg %>
                      </span>
                      <% }%>
                        <div class="row">
                          <div class="col-sm-12 col-lg-12" id="ifYes">
                            <div class="">
                              <input type=" text" class="form-control text-field spods_pl_claim_details" id="spods_pl_claim_details"
                                placeholder="*Please enter PI claim Details" name="spods_pl_claim_details" value="">
                            </div>
                          </div>
                        </div>

                        <div class="row">
                          <div class="col-sm-12 col-lg-4">
                            <div class="profile-notes">
                              <p>Do you hold your own PI cover?
                              </p>
                            </div>
                          </div>

                          <div class="col-sm-12 col-lg-2">
                            <div class="profile-radio">
                              <label class="radio-inline">
                                <input type="radio" name="spods_option_pl_cover" value="yes"
                                  onclick="javascript:yesnoCheck2();" id="yesCheck2_p6" >
                                &nbsp;Yes&nbsp;&nbsp;
                              </label>
                              <label class="radio-inline">
                                <input type="radio" checked name="spods_option_pl_cover" value="no"
                                  onclick="javascript:yesnoCheck2();" id="noCheck2_p6"> &nbsp;No&nbsp;&nbsp;
                              </label>
                            </div>
                          </div>

                        </div>

                        <div id="ifYes2">
                          <div class="row">
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix3">
                                <input type="text" class="form-control text-field-size spods_name_insurer" id="spods_name_insurer"
                                  placeholder="Name of Insurer" name="spods_name_insurer">
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix3">
                                <input type="text" name="spods_broker_details" value="" class="form-control text-field-size spods_broker_details" id="spods_broker_details"
                                  placeholder="Broker Details(if applicable)" >
                              </div>
                            </div>
                          </div>


                          <div class="row">
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix3">
                                <input type="text" class="form-control text-field-size spods_level_of_cover" id=""
                                  placeholder="Level of cover" name="spods_level_of_cover" value="">
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                              <div class="input-box-size-fix3">
                                <input type="text" onfocus="(this.type='date')" class="form-control text-field-size spods_renewal_date"
                                  id="spods_renewal_date" placeholder="Renewal Date" name="spods_renewal_date" value="">
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="row btn-sec">
                          <div class="col-6 col-sm-6 col-lg-6">
                            <div class="prev-btn-fix float-left">
                              <a href="/signup-professionals-profile-5" class="btn previous-btn" style="width: 164px; ">
                                PREVIOUS</a>
                            </div>
                          </div>


                          <div class="col-6 col-sm-6 col-lg-6">
                            <div class="prev-btn-fix float-right">
                              <!-- <a href="/signup-professionals-profile-7" class="btn btn-next" style="width: 164px;">
                        NEXT</a> -->
                        <input type="hidden" name="indemnity_detail_id" class="indemnity_detail_id">
                              <button type="submit" name="submit" class="btn btn-next" style="width: 164px;">
                                NEXT</button>
                            </div>
                          </div>

                        </div>
              </form>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" src="../js/countrystatecity.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10/dist/sweetalert2.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.2/jquery.validate.min.js"
    integrity="sha512-UdIMMlVx0HEynClOIFSyOrPggomfhBKJE28LKl8yR3ghkgugPnG6iLfRfHwushZl1MOPSY6TsuBDGPK2X4zYKg=="
    crossorigin="anonymous"></script>

  <script type="text/javascript">
    $('#form6').validate({
      onfocusout: function (element) {
        this.element(element);
      },
      errorClass: 'error_validate',
      errorElement: 'span',
      highlight: function (element, errorClass) {
        $(element).removeClass(errorClass);
      },
      submitHandler: function (form) {
        $('.loader-box').attr('style', 'display:flex !important');
        var formData = $('#form6').serialize();

        console.log('formData:', formData)
        $.ajax({
          type: "POST",
          data: formData,
          url: "/api/service_provider_indemnity_details",
          cache: false,
          success: function (data) {
            console.log(data);
            if (data.status == false) {
              $('.loader-box').attr('style', 'display:none !important');

              Swal.fire({
                icon: 'error',
                title: data.message,
                showConfirmButton: false,
                confirmButtonColor: '#005377',
                timer: 4000
              })
              if (data.redirectpage == true) {
                setTimeout(function () {
                  //location.reload(true);
                  window.location.href = data.redirect;
                }, 4000);
              }


            } else {
              $('.loader-box').attr('style', 'display:none !important');

              Swal.fire({
                icon: 'success',
                title: data.message,
                showConfirmButton: false,
                confirmButtonColor: '#005377',
                timer: 4000
              })

              setTimeout(function () {
                //location.reload(true);
                window.location.href = "/signup-professionals-profile-7";
              }, 4000);

            }
          }
        });


      }
    });
  </script>
  <script type="text/javascript">
    document.getElementById('ifYes').style.display = 'none';
    window.onload = function () {

    }
  // $("#yesCheck_p6").click(function(e){
  //   alert()
  // })
    function yesnoCheck() {
      //alert()
      if (document.getElementById('yesCheck_p6').checked) {
        document.getElementById('ifYes').style.display = 'block';
        $('.spods_pl_claim_details').attr('required',true)
      }
      else if(document.getElementById('noCheck_p6').checked){
        document.getElementById('ifYes').style.display = 'none';
        $('.spods_pl_claim_details').attr('required',false)
      }
    }

  </script>
  <script type="text/javascript">
    window.onload = function () {
      document.getElementById('ifYes2').style.display = 'none';
    }

    function yesnoCheck2() {
      if (document.getElementById('yesCheck2_p6').checked) {
        document.getElementById('ifYes2').style.display = 'block';
                $('.spods_name_insurer').attr('required',true)
                $('.spods_broker_details').attr('required',true)
                $('.spods_level_of_cover').attr('required',true)
                $('.spods_renewal_date').attr('required',true)
      }
      else {
        document.getElementById('ifYes2').style.display = 'none';
        $('.spods_name_insurer').attr('required',false)
                $('.spods_broker_details').attr('required',false)
                $('.spods_level_of_cover').attr('required',false)
                $('.spods_renewal_date').attr('required',false)
      }
    }

  </script>
  <script type="text/javascript">
    $(document).ready(function () {
      var flash_msg = $('.flash_msg').html();
      if (flash_msg != "" && flash_msg != undefined) {
        setTimeout(function () { $('.flash_msg').html(''); }, 4000);
      }
    });

    $(document).ready(function () {
      var succ_flash_msg = $('.succ_flash_msg').html();
      if (succ_flash_msg != "" && succ_flash_msg != undefined) {
        setTimeout(function () { $('.succ_flash_msg').html(''); }, 4000);
      }
    });
  </script>
  <script type="text/javascript">
    $(document).ready(function () {
      var newHref1 = $('.other_detail_nev').attr('data-href');
        $('.other_detail_nev').attr('href',newHref1);
        var newHref2 = $('.education_detail_nev').attr('data-href');
        $('.education_detail_nev').attr('href',newHref2);
        var newHref3 = $('.employment_detail_nev').attr('data-href');
        $('.employment_detail_nev').attr('href',newHref3);
        var newHref4 = $('.refrence_detail_nev').attr('data-href');
        $('.refrence_detail_nev').attr('href',newHref4);
        var newHref5 = $('.refrence_detail_nev').attr('data-href');
        $('.refrence_detail_nev').attr('href',newHref5);
        var newHref6 = $('.indemnity_detail_nev').attr('data-href');
        $('.indemnity_detail_nev').attr('href',newHref6);
      spods_renewal_date.min=new Date().toISOString().split('T')[0];
      var data = {
        user_id:'<%= session.user_id%>'
      }
     // alert("<%= session.user_id%>")
      $.ajax({
          type: "GET",
          data: data,
          url: "/api/service_provider_indemnity_details",
          cache: false,
          success: function (data) {
            console.log(data);
            if (data.status == true) {
              
        var newHref7 = $('.language_detail_nev').attr('data-href');
        $('.language_detail_nev').attr('href',newHref7);
              $('.indemnity_detail_id').val(data.data._id);
              var date    = new Date(data.data.spods_renewal_date),
              yr      = date.getFullYear(),
              month   = date.getMonth() < 10 ? '0' + date.getMonth() : date.getMonth(),
              day     = date.getDate()  < 10 ? '0' + date.getDate()  : date.getDate(),
              newDate =  yr+ '-' + month + '-' + day;
              if(data.data.spods_option_pl_claims=='yes'){
                $('.spods_pl_claim_details').val(data.data.spods_pl_claim_details)
                $("#yesCheck_p6").attr('checked', 'checked');
                document.getElementById('ifYes').style.display = 'block';
               
              }else{
                $('.spods_pl_claim_details').val('')
                $("#noCheck_p6").attr('checked', 'checked');
                document.getElementById('ifYes').style.display = 'none';
              }
              if(data.data.spods_option_pl_cover=='yes'){
                $('.spods_name_insurer').val(data.data.spods_name_insurer)
                $('.spods_broker_details').val(data.data.spods_broker_details)
                $('.spods_level_of_cover').val(data.data.spods_level_of_cover)
                $('.spods_renewal_date').val(newDate)
                $("#yesCheck2_p6").attr('checked', 'checked');
                document.getElementById('ifYes2').style.display = 'block';
               
              }else{
                $('.spods_name_insurer').val('')
                $('.spods_broker_details').val('')
                $('.spods_level_of_cover').val('')
                $('.spods_renewal_date').val('')
                $("#noCheck2_p6").attr('checked', 'checked');
                document.getElementById('ifYes2').style.display = 'none';
              }

          }
        }
      })
    });

  </script>
  </body>

  </html>